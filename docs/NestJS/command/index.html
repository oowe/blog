<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/blog/rss.xml" title="OOWE&#39;s Blog Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/blog/atom.xml" title="OOWE&#39;s Blog Blog Atom Feed"><title data-react-helmet="true">Command | OOWE&#x27;s Blog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://oowe.github.io/blog/docs/NestJS/command"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Command | OOWE&#x27;s Blog"><meta data-react-helmet="true" name="description" content="Reference from https://dev.to/santypk4/bulletproof-node-js-project-architecture-4epf"><meta data-react-helmet="true" property="og:description" content="Reference from https://dev.to/santypk4/bulletproof-node-js-project-architecture-4epf"><link data-react-helmet="true" rel="shortcut icon" href="/blog/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://oowe.github.io/blog/docs/NestJS/command"><link data-react-helmet="true" rel="alternate" href="https://oowe.github.io/blog/docs/NestJS/command" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://oowe.github.io/blog/docs/NestJS/command" hreflang="x-default"><link rel="stylesheet" href="/blog/assets/css/styles.adc17638.css">
<link rel="preload" href="/blog/assets/js/runtime~main.79a68877.js" as="script">
<link rel="preload" href="/blog/assets/js/main.6b04cab1.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/blog/"><img src="/blog/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/blog/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">OOWE</b></a><a class="navbar__item navbar__link navbar__link--active" href="/blog/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oowe" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorial - Basics</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorial - Extras</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">AWS</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">AlmaLinux</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Althttpd</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Angular</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Django</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Docker</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Docusaurus2</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Git</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Github</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Java</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Logger</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Markdown</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">MySQL Workbench</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">MySQL</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">NestJS</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog/docs/NestJS/command">Command</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/NestJS/jest">Jest</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/NestJS/restful-api">RESTful API</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/blog/docs/NestJS/typeorm">TypeORM</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">NodeJS</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">OpenADR</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Oracle VM VirtualBox</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">PostgreSQL</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Postman</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Python</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Ruby</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Shell Script</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">TLS</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Typescript</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Ubuntu</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Visual Studio Code</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Visual Studio</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Wireshark</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">XML</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Command</h1></header><p><strong>Reference from <a href="https://dev.to/santypk4/bulletproof-node-js-project-architecture-4epf" target="_blank" rel="noopener noreferrer">https://dev.to/santypk4/bulletproof-node-js-project-architecture-4epf</a></strong></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="好用工具"></a>好用工具<a class="hash-link" href="#好用工具" title="Direct link to heading">#</a></h3><ul><li>Json formatter (for chrome)</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="nest-指令"></a>nest 指令<a class="hash-link" href="#nest-指令" title="Direct link to heading">#</a></h3><ul><li>安裝 cli</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> -g @nestjs/cli</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>建立專案</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  nest new nest-crash-course</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>運行程式</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> run start:dev</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>建立</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> i generate</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>模組</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  nest g mo </span><span class="token function" style="color:#d73a49">users</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>控制器</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  nest g co </span><span class="token function" style="color:#d73a49">users</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>服務</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  nest g </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">users</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="三層架構"></a>三層架構<a class="hash-link" href="#三層架構" title="Direct link to heading">#</a></h3><p>可分成 Controller, Service Layer, Data Access Layer</p><ul><li><p>Controller</p><ul><li>負責路由 get, post, put, delete, patch（RESTful api）</li><li>正確與錯誤響應<ul><li>200 success</li><li>404 not found</li><li>500 internal server error</li></ul></li></ul></li><li><p>Service Layer</p><ul><li>負責邏輯</li><li>與資料庫溝通的 code</li></ul></li><li><p>Data Access Layer</p><ul><li>資料庫的連結與存取</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="操作"></a>操作<a class="hash-link" href="#操作" title="Direct link to heading">#</a></h3><ul><li>在@Controller(&#x27;app&#x27;) 加上 app<ul><li>代表將所有路由灌上 app 字眼</li></ul></li><li>在 nestjs 內有很多裝飾器，可以方便使用</li><li>在@Get(&#x27;hello&#x27;)加上 hello<ul><li>代表在 get 路由要加上 hello 的前綴才能訪問到</li></ul></li><li>@Module{ imports: [users] }<ul><li>當你建立一個新的 module 它必須被 import 進來才能使用</li></ul></li><li>controller.spec.ts<ul><li>spec.ts 結尾的檔案用在測試使用</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="difference-between-npm-i---save-and-npm-i---save-dev"></a>Difference between &#x27;npm i --save&#x27; and &#x27;npm i --save-dev&#x27;<a class="hash-link" href="#difference-between-npm-i---save-and-npm-i---save-dev" title="Direct link to heading">#</a></h3><p>dependencies：你用了什麼套件 (產品運行要的套件)
devDependencies：你只有在開發或測試的時候需要的套件 (開發測試時候需要用的)
在 npm v5.0.0 之後，--save 已經成為預設指令
npm install -save == npm install</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="npm-install--g-全域安裝"></a>npm install -g (全域安裝)<a class="hash-link" href="#npm-install--g-全域安裝" title="Direct link to heading">#</a></h3><p>如果沒有打-g 指令的話只會安裝在 node_module 內
如果有打的話，直接在 terminal 上就可以執行指令
example: sudo npm install -g jest
你在 terminal 下 jest 就可以使用
若要移除的話需要下 sudo npm uninstall -g jest</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="npm-init"></a>npm init<a class="hash-link" href="#npm-init" title="Direct link to heading">#</a></h3><p>npm init 執行的動作很簡單
那就只是幫我們創建 package.json 的 boilerplate</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="npm-install-及-packagejson-的用途"></a>npm install 及 package.json 的用途<a class="hash-link" href="#npm-install-及-packagejson-的用途" title="Direct link to heading">#</a></h3><p>node_module 的誕生是因為，相同套件 for 不同專案，有時後有不能共用的問題
優點: 資料夾獨立，模組管理方便
缺點: 佔用空間多
基於這個缺點，只需要複製原始碼和 package.json，到新的電腦，重新 npm install。</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="package-lockjson-的用途"></a>package-lock.json 的用途<a class="hash-link" href="#package-lockjson-的用途" title="Direct link to heading">#</a></h3><p>依照 package.json 所安裝的套件，也會安裝 dependies 的套件，而這些版本號會被紀錄在 package-lock.json。
更新的指令包含 npm install / uninstall /update 都會去更新</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="module-controller-and-service"></a>Module, Controller and Service<a class="hash-link" href="#module-controller-and-service" title="Direct link to heading">#</a></h3><p>在 nestjs 內，不同的功能會建立在不同的 Module 上
每個 Module 會有一個 Controller 做 routing 這件事情
再用一個或多個 Service 把複雜的運算及功能寫成 function</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="defult-script-in-packagejson"></a>Defult script in package.json<a class="hash-link" href="#defult-script-in-packagejson" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;scripts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;prebuild&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rimraf dist&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;build&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nest build&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;format&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;prettier --write \&quot;src/**/*.ts\&quot; \&quot;test/**/*.ts\&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;start&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nest start&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;start:dev&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nest start --watch&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;start:debug&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nest start --debug --watch&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;start:prod&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;node dist/main&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;lint&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eslint \&quot;{src,apps,libs,test}/**/*.ts\&quot; --fix&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;test&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jest&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;test:watch&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jest --watch&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;test:cov&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jest --coverage&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;test:debug&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;test:e2e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jest --config ./test/jest-e2e.json&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="npm-build"></a>npm build<a class="hash-link" href="#npm-build" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> 等於 nest build</span></span><span class="token-line" style="color:#393A34"><span class="token plain">是將 dist 資料夾建出來</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="spects-檔案"></a>.spec.ts 檔案<a class="hash-link" href="#spects-檔案" title="Direct link to heading">#</a></h3><p>.spec 或.test 結尾的檔案是用來做 Jest 測試使用的
//針對控制器的單元測試</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="linux-指令"></a>linux 指令<a class="hash-link" href="#linux-指令" title="Direct link to heading">#</a></h3><p>./ 當前目錄
../ 上一層</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="建立-module"></a>建立 module<a class="hash-link" href="#建立-module" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">nest g mo </span><span class="token function" style="color:#d73a49">users</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">nest g co </span><span class="token function" style="color:#d73a49">users</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">nest g resource </span><span class="token function" style="color:#d73a49">users</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="problem-常發生的問題"></a>Problem （常發生的問題)<a class="hash-link" href="#problem-常發生的問題" title="Direct link to heading">#</a></h3><p><strong>Reference from <a href="https://ithelp.ithome.com.tw/articles/10242768" target="_blank" rel="noopener noreferrer">https://ithelp.ithome.com.tw/articles/10242768</a></strong>
Nest can&#x27;t resolve dependencies of the AppController (AppService, ?). Please make sure that the argument StudentService at index [1] is available in the AppModule context.</p><p>解決方式: 通常是 AppService 沒有被 import 到 app module 內</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="file-upload"></a>File upload<a class="hash-link" href="#file-upload" title="Direct link to heading">#</a></h3><ul><li><p>安裝套件: npm i -D @types/multer</p></li><li><p>處理資料格式: multipart/form-data</p><ul><li><strong>Reference from <a href="https://blog.kalan.dev/2021-03-13-html-form-data/" target="_blank" rel="noopener noreferrer">https://blog.kalan.dev/2021-03-13-html-form-data/</a></strong></li><li>一般的 Content-Type 往往只能傳送一種形式的資料，但在網頁的應用當中我們還可能想要上傳檔案、圖片、影片在表單裡頭，這樣的需求促成了 multipart/form-data 規範的出現</li></ul></li><li><p>傳遞方式: POST 方法</p></li><li><p>要上傳單個文件，只需將 FileInterceptor()攔截器綁定到路由處理程序並 file 從 requestusing@UploadedFile()裝飾器中提取。</p></li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">Body</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Controller</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Delete</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Get</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Param</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Post</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token maybe-class-name">UploadedFile</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">UseInterceptors</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@nestjs/common&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">Post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;upload&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">UseInterceptors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function maybe-class-name" style="color:#d73a49">FileInterceptor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;file&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">uploadFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">UploadedFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> file</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Express</span><span class="token punctuation" style="color:#393A34">.</span><span class="token maybe-class-name">Multer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token maybe-class-name">File</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>使用 postman，在 body 頁選擇 form-data，輸入 key 爲 file，選擇一個檔案，直接 sand 即可</p><p>Q:ERROR [ExceptionsHandler] Multipart: Boundary not found
A:不需要重複設置 Content-Type: mutipart/form-data 否則可能會覆蓋原有的， 造成非預期的錯誤</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="將-file-的值讀出來"></a>將 file 的值讀出來<a class="hash-link" href="#將-file-的值讀出來" title="Direct link to heading">#</a></h3><p>file.buffer 是檔案的內容的值，型態爲 object
先轉成 string 的形態，再轉成 Json 格式讀出</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">buffer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> data_string </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> data_string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> data_json </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_json</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> data_json</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_json</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;username&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> fieldname</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;file&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  originalname</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example.json&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  encoding</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;7bit&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  mimetype</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;application/json&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  buffer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Buffer</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">7b</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">0a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">09</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">22</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">66</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">69</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">72</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">73</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">74</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">4e</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">61</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">6d</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">65</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">22</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">3a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">20</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">22</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">61</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">61</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">72</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">6f</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">6e</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">22</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">2c</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">0a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">09</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">22</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">6c</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">61</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">73</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">74</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">4e</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">61</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">6d</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">65</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">22</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">3a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">20</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">22</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">63</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">68</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">61</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">6e</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">67</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">22</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">0a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">7d</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">0a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">,</span></span><span class="token-line" style="color:#393A34"><span class="token plain-text">  size: 48 }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>鑰匙 描述 筆記<br>
fieldname 表單中指定的字段名稱<br>
originalname 用戶計算機上的文件名<br>
encoding 文件的編碼類型<br>
mimetype 文件的 MIME 類型<br>
size 文件的大小（以字節為單位）<br>
destination 保存文件的文件夾 DiskStorage<br>
filename 內的文件名 destination DiskStorage<br>
path 上傳文件的完整路徑 DiskStorage<br>
buffer ABuffer 整個文件 MemoryStorage</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="entity-紀錄"></a>@Entity 紀錄<a class="hash-link" href="#entity-紀錄" title="Direct link to heading">#</a></h3><ul><li>@Entity()是將資料表實體化成資料庫的 table</li><li>@Entity(&#x27;table_name&#x27;) 及 @Entity({name:&#x27;table_name&#x27;})可以命名 table 的 name<ul><li>若留空白，是以 class name 當作 table name</li><li>class name 是以大寫爲分隔_，　 example: &#x27;sceneScheduleEntity&#x27;則為&#x27;scene_schedule_entity&#x27;</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="檔案命名規則"></a>檔案命名規則<a class="hash-link" href="#檔案命名規則" title="Direct link to heading">#</a></h3><ul><li>nestjs 的檔名通常命名爲 filename.功能.ts， example: archive.entity.ts</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="import-service"></a>Import service<a class="hash-link" href="#import-service" title="Direct link to heading">#</a></h3><p><strong>若 A service 要 import B service 需要做以下步驟</strong></p><ol><li>在 A service 的 constructor 實體化物件 &quot;private readonly logger: EmsLogger&quot;</li><li>在 A module &quot;imports:[B module]&quot;</li><li>在 B module 輸出 sevice &quot;exports: [B Service]&quot;</li><li>完成</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="nestjs-概念"></a>Nestjs 概念<a class="hash-link" href="#nestjs-概念" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">main.ts -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> app.module -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> app.controller -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> app.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="程式進入點maints"></a>程式進入點(main.ts)<a class="hash-link" href="#程式進入點maints" title="Direct link to heading">#</a></h3><ul><li>bootstarp() 呼叫 function bootstarp()再呼叫 function parseCli<ul><li>若 state=cofig 會呼叫 function configApp()</li><li>若 state=dcs 會呼叫 function DataCollectionApp()</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="重跑-migrations-的方法"></a>重跑 migrations 的方法<a class="hash-link" href="#重跑-migrations-的方法" title="Direct link to heading">#</a></h3><p>migrations 的概念是，有跑過的會記錄在 migrations table，當下次程式運行的時候，會先檢查有沒有跑過，若有就不會在跑了，所以記得要砍紀錄。</p><ol><li>砍紀錄</li></ol><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">select *  from `migrations`;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">delete from `migrations` where id={id};</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>修改 migrations 檔案</li></ol><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">   建立一個新的檔案，裡面要有 up 和 down function</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   若是修改舊的檔案，要把不需要重跑的地方註解掉，不然相同的資料會重複 insert</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="class-validator"></a>Class-validator<a class="hash-link" href="#class-validator" title="Direct link to heading">#</a></h3><p><strong>Reference from <a href="https://github.com/typestack/class-validator" target="_blank" rel="noopener noreferrer">https://github.com/typestack/class-validator</a></strong></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="目的"></a>目的<a class="hash-link" href="#目的" title="Direct link to heading">#</a></h3><p>利用 DTO 檢查輸入的資料格式，是否符合預期。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="install-class-validator"></a>Install class-validator<a class="hash-link" href="#install-class-validator" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> i --save class-validator class-transformer</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/main/website/docs/NestJS/command.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/docs/MySQL/document"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Document</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/docs/NestJS/jest"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Jest »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#好用工具" class="table-of-contents__link">好用工具</a></li><li><a href="#nest-指令" class="table-of-contents__link">nest 指令</a></li><li><a href="#三層架構" class="table-of-contents__link">三層架構</a></li><li><a href="#操作" class="table-of-contents__link">操作</a></li><li><a href="#difference-between-npm-i---save-and-npm-i---save-dev" class="table-of-contents__link">Difference between &#39;npm i --save&#39; and &#39;npm i --save-dev&#39;</a></li><li><a href="#npm-install--g-全域安裝" class="table-of-contents__link">npm install -g (全域安裝)</a></li><li><a href="#npm-init" class="table-of-contents__link">npm init</a></li><li><a href="#npm-install-及-packagejson-的用途" class="table-of-contents__link">npm install 及 package.json 的用途</a></li><li><a href="#package-lockjson-的用途" class="table-of-contents__link">package-lock.json 的用途</a></li><li><a href="#module-controller-and-service" class="table-of-contents__link">Module, Controller and Service</a></li><li><a href="#defult-script-in-packagejson" class="table-of-contents__link">Defult script in package.json</a></li><li><a href="#npm-build" class="table-of-contents__link">npm build</a></li><li><a href="#spects-檔案" class="table-of-contents__link">.spec.ts 檔案</a></li><li><a href="#linux-指令" class="table-of-contents__link">linux 指令</a></li><li><a href="#建立-module" class="table-of-contents__link">建立 module</a></li><li><a href="#problem-常發生的問題" class="table-of-contents__link">Problem （常發生的問題)</a></li><li><a href="#file-upload" class="table-of-contents__link">File upload</a></li><li><a href="#將-file-的值讀出來" class="table-of-contents__link">將 file 的值讀出來</a></li><li><a href="#entity-紀錄" class="table-of-contents__link">@Entity 紀錄</a></li><li><a href="#檔案命名規則" class="table-of-contents__link">檔案命名規則</a></li><li><a href="#import-service" class="table-of-contents__link">Import service</a></li><li><a href="#nestjs-概念" class="table-of-contents__link">Nestjs 概念</a></li><li><a href="#程式進入點maints" class="table-of-contents__link">程式進入點(main.ts)</a></li><li><a href="#重跑-migrations-的方法" class="table-of-contents__link">重跑 migrations 的方法</a></li><li><a href="#class-validator" class="table-of-contents__link">Class-validator</a></li><li><a href="#目的" class="table-of-contents__link">目的</a></li><li><a href="#install-class-validator" class="table-of-contents__link">Install class-validator</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Local Link</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/docs/intro">Doc</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">About Me</div><ul class="footer__items"><li class="footer__item"><a href="mailto:oowe9564@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Gmail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/aaron-chang-oowe/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/oowe" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022-2022 OOWE. Built with Docusaurus.</div></div></div></footer></div>
<script src="/blog/assets/js/runtime~main.79a68877.js"></script>
<script src="/blog/assets/js/main.6b04cab1.js"></script>
</body>
</html>