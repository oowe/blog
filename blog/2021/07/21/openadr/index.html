<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/blog/rss.xml" title="OOWE&#39;s Software Develop Notes Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/blog/atom.xml" title="OOWE&#39;s Software Develop Notes Blog Atom Feed"><title data-react-helmet="true">OpenADR Introduction | OOWE&#x27;s Software Develop Notes</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://oowe.github.io/blog/blog/2021/07/21/openadr"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="OpenADR Introduction | OOWE&#x27;s Software Develop Notes"><meta data-react-helmet="true" name="description" content="OpenADR 是由美國的實驗室(LBNL)在西元 2008 年發表 OpenADR1.0 所誕生。全名為 Open Source Auto Demand Resonse(自動需量反應)。"><meta data-react-helmet="true" property="og:description" content="OpenADR 是由美國的實驗室(LBNL)在西元 2008 年發表 OpenADR1.0 所誕生。全名為 Open Source Auto Demand Resonse(自動需量反應)。"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-07-21T00:00:00.000Z"><link data-react-helmet="true" rel="shortcut icon" href="/blog/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://oowe.github.io/blog/blog/2021/07/21/openadr"><link data-react-helmet="true" rel="alternate" href="https://oowe.github.io/blog/blog/2021/07/21/openadr" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://oowe.github.io/blog/blog/2021/07/21/openadr" hreflang="x-default"><link rel="stylesheet" href="/blog/assets/css/styles.adc17638.css">
<link rel="preload" href="/blog/assets/js/runtime~main.150d87be.js" as="script">
<link rel="preload" href="/blog/assets/js/main.9b16f49f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/blog/"><img src="/blog/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/blog/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">OOWE</b></a><a class="navbar__item navbar__link" href="/blog/docs/intro">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oowe" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/blog/fitness">Fitness</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/blog/setup-computer">Setup Computer</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/blog/backup-restore-function">Backup Restore Function</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/blog/oxygen-management-system">Oxygen Management System</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/blog/survey-openadr">Survey OpenADR</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">OpenADR Introduction</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-07-21T00:00:00.000Z" itemprop="datePublished">July 21, 2021</time> · 5 min read</div></header><div class="markdown" itemprop="articleBody"><p>OpenADR 是由美國的實驗室(LBNL)在西元 2008 年發表 OpenADR1.0 所誕生。全名為 Open Source Auto Demand Resonse(自動需量反應)。<br>
目的是一種通訊的協定，定義能源互相操控各式訊息，用以傳遞價格、可靠度及在緊急時的通訊。此類訊息可以在任何可用的通訊界面上進行交換，此定義和技術通訊無關。<br>
台電目前，今年七月開始導入 OpenADR 和國中小學的 EMS 系統溝通，主要希望能夠改善用戶的負載型態，提高能源的使用率，平衡尖峰與離峰負仔和減少電能消耗。諸多國外市場已採用需量反應制度。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="名詞定義"></a>名詞定義：<a class="hash-link" href="#名詞定義" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">VTN: Virtrul Top Node (電力供應者:台電的角色)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">VEN: Virtrul End Node (終端設備:國中小學的 EMS 系統)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">OpenADR 運作原理：</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">通常會由 VTN 發起事件(Event)到 VEN 請裝置配合。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">VEN 會回報(report)到 VTN，提供 VTN 進行分析與判斷。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">實際的溝通訊息，由台電和供應商之間所協議。 (ADR 聯盟有初版定義仍可自訂)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">台電需要提供各學校的 ven_name 的名稱對應表，才會拿到對的 ven_id。</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="openadr20b-規格包含"></a>OpenADR2.0b 規格包含:<a class="hash-link" href="#openadr20b-規格包含" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Pull/Push Model (SimpleHttp 使用)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SimpleHTTP/XMPP (VTN 都必須支援、VEN 可支援其一)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Security(ECC/RCA) (至少要 LTS1.2 版本)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">EiEvent (VTN 發出事件給 VEN)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">EiReport (VEN 向 VTN 回報)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">EiOpt (VEN 收到 Event 回覆 Opt-in 或 Opt-out)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">EiRegistor (VEN 向 VTN 註冊)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Pull/Push Model 部分</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">由 VTN 到 VTN 是 Push</span></span><span class="token-line" style="color:#393A34"><span class="token plain">由 VEN 到 VTN 是 Pull</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   絕大多數的情況是 Pull(VEN 傳訊息到 VTN)，優點是安全性高及便利性，VEN 可以不需要有實體對外 IP 位置；缺點是溝通效率較差，有 Poll 去問才知道新的訊息。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">SimpleHTTP/XMPP 部分</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  openleadr 是主要採用 SimpleHttp，EPRI 是 XMPP 協定。但其實兩者都可以更換。依 OpenADR 聯盟規定，VTN 需要同時支援兩者，而 VEN 可同時支援或擇一。</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Security(ECC/RCA) 部分</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="eievent-部分"></a>EiEvent 部分<a class="hash-link" href="#eievent-部分" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">   是 OpenADR 的核心服務，VTN 透過此服務將需量反應的必要資訊傳送到各個 VEN 設備。VTN 可以建立多個 Event，指派給不同的 ven_id、group_id、source_id 等目標 Target。</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">※ 待了解 EiEvent 的訊號時間軸，怎麼在程式上設定</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Notification time: 事件前的通知時間，在 Active state 之前。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Rampup time: VEN 收到 Event 若回覆同意之後逐步卸除負載的時間。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Active time: 事件啟動時間，搭配 Duration 參數。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Recovery time: 當事件結束後，VEN 逐步恢復負載的時間。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">main function (add_event):</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="eireport-部分"></a>EiReport 部分<a class="hash-link" href="#eireport-部分" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">報表回覆功能，可自訂成一次性報告或是定期性兩種。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">報表類型包含 METADATA、DATA REPORTS</span></span><span class="token-line" style="color:#393A34"><span class="token plain">DATA REPORTS 包含</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">History (歷史資料)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">telemetey (定期資料)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">MATADATA 是說明 DATA REPORT 的格式</span></span><span class="token-line" style="color:#393A34"><span class="token plain">DATA REPORT 是回報資料點的數據，可以同時包含一個或多個資料點。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">main function (add_report):</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="eiopt-部分"></a>EiOpt 部分<a class="hash-link" href="#eiopt-部分" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Opt 服務是讓</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">EiRegistor 部分</span></span><span class="token-line" style="color:#393A34"><span class="token plain">運作原理:先 Query 得到 VTN 資訊在傳送 Create 註冊，最後 VTN 回傳 Created 給 VEN 回傳成功。</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">查詢註冊</span></span><span class="token-line" style="color:#393A34"><span class="token plain">VEN 先運行 oadrQueryRegistartion()傳到 VTN，接著 VTN 再傳 oadrCreatedPartyRegistration(VTN Info)給 VEN。</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">註冊創建</span></span><span class="token-line" style="color:#393A34"><span class="token plain">VEN 再運行 oadrCreatePartyRegistration(VEN Info)傳到 VTN，接著 VTN 再傳 oadrCreatedPartyRegistration(VTN Info, registrationID)接著 VEN。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">完成註冊</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">重新註冊</span></span><span class="token-line" style="color:#393A34"><span class="token plain">可由</span></span><span class="token-line" style="color:#393A34"><span class="token plain">VTN 先運行 oadrRequestRegistration(VEN ID)傳到 VEN，接著 VTN 傳 oadrRespose()傳到 VEN。</span></span><span class="token-line" style="color:#393A34"><span class="token plain">或者</span></span><span class="token-line" style="color:#393A34"><span class="token plain">VEN 再運行 oadrCreatedPartyRegistration(VEN Info, registrationID)傳到 VTN，接著 VTN 再傳 oadrCreatedPartyRegistration(VTN Info, registrationID)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">取消註冊</span></span><span class="token-line" style="color:#393A34"><span class="token plain">雙方都可以執行</span></span><span class="token-line" style="color:#393A34"><span class="token plain">運行 oadrCancellPartyRegistration(registrationID)傳到 VTN，接著對方再傳 oadrCancelledPartyRegistration()</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="備註"></a>備註<a class="hash-link" href="#備註" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">openleadr 使用的環境</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">openleadr 版本: 0.5.24</span></span><span class="token-line" style="color:#393A34"><span class="token plain">python3.7 以上</span></span><span class="token-line" style="color:#393A34"><span class="token plain">有使用到的套件</span></span><span class="token-line" style="color:#393A34"><span class="token plain">xmltodict</span></span><span class="token-line" style="color:#393A34"><span class="token plain">aiohttp</span></span><span class="token-line" style="color:#393A34"><span class="token plain">apscheduler</span></span><span class="token-line" style="color:#393A34"><span class="token plain">jinja2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">signxml-openadr-2.9.1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/blog/milk-serum"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« Milk Serum</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#名詞定義" class="table-of-contents__link">名詞定義：</a></li><li><a href="#openadr20b-規格包含" class="table-of-contents__link">OpenADR2.0b 規格包含:</a></li><li><a href="#eievent-部分" class="table-of-contents__link">EiEvent 部分</a></li><li><a href="#eireport-部分" class="table-of-contents__link">EiReport 部分</a></li><li><a href="#eiopt-部分" class="table-of-contents__link">EiOpt 部分</a></li><li><a href="#備註" class="table-of-contents__link">備註</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Local Link</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/docs/intro">Doc</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">About Me</div><ul class="footer__items"><li class="footer__item"><a href="mailto:oowe9564@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Gmail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/aaron-chang-oowe/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/oowe" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022-2022 OOWE. Built with Docusaurus.</div></div></div></footer></div>
<script src="/blog/assets/js/runtime~main.150d87be.js"></script>
<script src="/blog/assets/js/main.9b16f49f.js"></script>
</body>
</html>