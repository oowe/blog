"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[4192],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var c=r.createContext({}),i=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=i(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,s=e.mdxType,l=e.originalType,c=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=i(n),m=s,k=d["".concat(c,".").concat(m)]||d[m]||p[m]||l;return n?r.createElement(k,a(a({ref:t},u),{},{components:n})):r.createElement(k,a({ref:t},u))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var l=n.length,a=new Array(l);a[0]=d;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:s,a[1]=o;for(var i=2;i<l;i++)a[i]=n[i];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9827:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return c},default:function(){return d},frontMatter:function(){return o},metadata:function(){return i},toc:function(){return u}});var r=n(7462),s=n(3366),l=(n(7294),n(3905)),a=["components"],o={},c="Jest",i={unversionedId:"NestJS/jest",id:"NestJS/jest",isDocsHomePage:!1,title:"Jest",description:"Reference from https://jestjs.io/",source:"@site/docs/NestJS/jest.md",sourceDirName:"NestJS",slug:"/NestJS/jest",permalink:"/blog/docs/NestJS/jest",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/NestJS/jest.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Command",permalink:"/blog/docs/NestJS/command"},next:{title:"RESTful API",permalink:"/blog/docs/NestJS/restful-api"}},u=[{value:"\u55ae\u5143\u6e2c\u8a66\u7cbe\u795e",id:"\u55ae\u5143\u6e2c\u8a66\u7cbe\u795e",children:[]},{value:"\u6e2c\u8a66\u57df",id:"\u6e2c\u8a66\u57df",children:[]},{value:"Install Jest",id:"install-jest",children:[]},{value:"import test class",id:"import-test-class",children:[]},{value:"\u55ae\u5143\u6e2c\u8a66",id:"\u55ae\u5143\u6e2c\u8a66",children:[]},{value:"\u55ae\u5143\u6e2c\u8a66(\u6bd4\u8f03\u7c21\u6f54\u7684\u5beb\u6cd5)",id:"\u55ae\u5143\u6e2c\u8a66\u6bd4\u8f03\u7c21\u6f54\u7684\u5beb\u6cd5",children:[]},{value:"\u6e2c\u8a66\u539f\u7406",id:"\u6e2c\u8a66\u539f\u7406",children:[]},{value:"Success Result",id:"success-result",children:[]},{value:"Fail Result",id:"fail-result",children:[]},{value:"parmeter",id:"parmeter",children:[]},{value:"linux command",id:"linux-command",children:[]},{value:"npm test:watch",id:"npm-testwatch",children:[]},{value:"\u8a2d\u8a08\u81ea\u52d5\u5316\u6e2c\u8a66\u6d41\u7a0b\u5728 DCS account Module",id:"\u8a2d\u8a08\u81ea\u52d5\u5316\u6e2c\u8a66\u6d41\u7a0b\u5728-dcs-account-module",children:[]},{value:"\u89e3\u6c7a Jest \u5728 test \u6642\u627e\u4e0d\u5230 module \u554f\u984c (20210701 \u9806\u5229\u89e3\u6c7a)",id:"\u89e3\u6c7a-jest-\u5728-test-\u6642\u627e\u4e0d\u5230-module-\u554f\u984c-20210701-\u9806\u5229\u89e3\u6c7a",children:[]},{value:"\u91cd\u9ede\u5728 mock",id:"\u91cd\u9ede\u5728-mock",children:[]},{value:"\u55ae\u5143\u6e2c\u8a66\u7684\u76ee\u7684",id:"\u55ae\u5143\u6e2c\u8a66\u7684\u76ee\u7684",children:[]},{value:"\u89e3\u6c7a\u6240\u6709\u76f8\u4f9d\u7684 dependies \u554f\u984c",id:"\u89e3\u6c7a\u6240\u6709\u76f8\u4f9d\u7684-dependies-\u554f\u984c",children:[]}],p={toc:u};function d(e){var t=e.components,n=(0,s.Z)(e,a);return(0,l.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"jest"},"Jest"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Reference from ",(0,l.kt)("a",{parentName:"strong",href:"https://jestjs.io/"},"https://jestjs.io/")),(0,l.kt)("br",{parentName:"p"}),"\n",(0,l.kt)("strong",{parentName:"p"},"Reference from ",(0,l.kt)("a",{parentName:"strong",href:"https://medium.com/enjoy-life-enjoy-coding/%E8%AE%93-jest-%E7%82%BA%E4%BD%A0%E7%9A%84-code-%E5%81%9A%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6-%E5%9F%BA%E7%A4%8E%E7%94%A8%E6%B3%95%E6%95%99%E5%AD%B8-d898f11d9a23"},"https://medium.com/enjoy-life-enjoy-coding/%E8%AE%93-jest-%E7%82%BA%E4%BD%A0%E7%9A%84-code-%E5%81%9A%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6-%E5%9F%BA%E7%A4%8E%E7%94%A8%E6%B3%95%E6%95%99%E5%AD%B8-d898f11d9a23"))),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},'\u6e2c\u8a66\u6a21\u7d44\u5305\u542b"Jasmine"\u548c Jest"\u70ba\u5927\u5b97\uff0c\u4f46 Jest \u662f\u9810\u8a2d\u5b89\u88dd\u2026'),(0,l.kt)("li",{parentName:"ol"},"\u7a0b\u5f0f\u6e2c\u8a66\u5305\u542b\u55ae\u5143\u6e2c\u8a66(unit test)\u3001\u7aef\u5230\u7aef (e2e) \u6e2c\u8a66\u3001\u96c6\u6210\u6e2c\u8a66\u3002"),(0,l.kt)("li",{parentName:"ol"},"Unit testing\uff0c\u55ae\u5143\u6e2c\u8a66\u3002 Jest \u662f\u4e00\u500b\u975e\u5e38\u6210\u719f\u7684\u6e2c\u8a66\u6846\u67b6"),(0,l.kt)("li",{parentName:"ol"},"nestjs \u6846\u67b6\u96c6\u6210\u4e86 jest \u6e2c\u8a66\u6846\u67b6\uff0c\u6e2c\u8a66\u6587\u4ef6\u5fc5\u9808\u4ee5.spec \u6216.test \u7d50\u5c3e\uff0c\u6e2c\u8a66\u6587\u4ef6\u4f4d\u65bc\u8207 src \u540c\u7d1a\u7684 test \u76ee\u9304\u4e0b("),(0,l.kt)("li",{parentName:"ol"},"\u653e\u5728 test \u8cc7\u6599\u593e\u5167\u6703\u8b80\u4e0d\u5230\uff0c\u9700\u8981\u8ddf controller \u653e\u5728\u4e00\u8d77"),(0,l.kt)("li",{parentName:"ol"},"Jest \u91dd\u5c0d Controller \u505a\u6e2c\u8a66"),(0,l.kt)("li",{parentName:"ol"},"\u5728 controler \u662f\u6e2c\u8def\u7531\uff0c\u5728 service \u662f\u6e2c\u908f\u8f2f\uff0c\u5169\u500b\u90fd\u9700\u8981\u6e2c\u8a66\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u901a\u5e38\u6e2c\u8a66\u4e0d\u6703\u9023 DB\uff0c\u90fd\u662f\u585e fake \u8cc7\u6599\uff0c\u505a\u9a57\u8b49\u800c\u5df2\u3002"),(0,l.kt)("li",{parentName:"ol"},"20210630-20210702 \u770b\u7684\u982d\u6688\u8166\u8139\uff0csivan \u5efa\u8b70\u5148\u505a\u7db2\u8def\u4e0a\u7c21\u55ae\u7684\u7bc4\u4f8b\u3002")),(0,l.kt)("h3",{id:"\u55ae\u5143\u6e2c\u8a66\u7cbe\u795e"},"\u55ae\u5143\u6e2c\u8a66\u7cbe\u795e"),(0,l.kt)("p",null,"\u55ae\u5143\u6e2c\u8a66\u5074\u91cd\u65bc\u70ba\u76e1\u53ef\u80fd\u5c0f\u7684\u55ae\u5143\u7de8\u5beb\u6e2c\u8a66\u3002\u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u5b83\u5011\u662f\u5728\u985e\u4e2d\u5b9a\u7fa9\u7684\u51fd\u6578\u3002\u4e00\u500b\u985e\u4e2d\u7684 MethodA \u53ef\u80fd\u6b63\u5728\u8abf\u7528\u53e6\u4e00\u500b\u985e\u4e2d\u7684 MethodB\u3002\u4f46\u662f\uff0cMethodA \u7684\u55ae\u5143\u6e2c\u8a66\u53ea\u95dc\u6ce8 MethodA \u7684\u908f\u8f2f\uff0c\u800c\u4e0d\u95dc\u6ce8 MethodB\u3002\u55ae\u5143\u6e2c\u8a66\u4e0d\u61c9\u8a72\u4f9d\u8cf4\u65bc\u5b83\u5011\u904b\u884c\u7684\u74b0\u5883\uff0c\u5b83\u5011\u61c9\u8a72\u662f\u5feb\u901f\u7684\u3002\u8981\u7de8\u5beb\u9694\u96e2\u7684\u55ae\u5143\u6e2c\u8a66\uff0c\u901a\u5e38\u6703\u6a21\u64ec\u65b9\u6cd5/\u670d\u52d9\u7684\u6240\u6709\u4f9d\u8cf4\u9805"),(0,l.kt)("h3",{id:"\u6e2c\u8a66\u57df"},"\u6e2c\u8a66\u57df"),(0,l.kt)("p",null,"beforeAll \uff1a\u6240\u5728\u5340\u57df\u5167\u6703\u7b2c\u4e00\u500b\u57f7\u884c\u3002\nbeforeEach \uff1a\u6bcf\u4e00\u6b21\u7684\u6e2c\u8a66\u524d\u6703\u5148\u57f7\u884c\u3002\nafterAll \uff1a\u6240\u5728\u5340\u57df\u5167\u6700\u5f8c\u4e00\u500b\u57f7\u884c\u3002\nafterEach \uff1a\u6bcf\u4e00\u6b21\u7684\u6e2c\u8a66\u5f8c\u6703\u99ac\u4e0a\u57f7\u884c\u3002"),(0,l.kt)("h3",{id:"install-jest"},"Install Jest"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"npm install --save-dev jest ts-jest @types/jest\n")),(0,l.kt)("h3",{id:"import-test-class"},"import test class"),(0,l.kt)("p",null,"in user.controller.spec.ts \u5167"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-tsx"},"//\u4f7f\u7528Nest Testing class\nbeforeEach(async () => {\n  const module = await Test.createTestingModule({\n    controllers: [UsersController],\n    components: [UsersService, ProductsService],\n  }).compile();\n\n  usersService = module.get<UsersService>(UsersService);\n  usersController = module.get<UsersController>(UsersController);\n});\n")),(0,l.kt)("h3",{id:"\u55ae\u5143\u6e2c\u8a66"},"\u55ae\u5143\u6e2c\u8a66"),(0,l.kt)("p",null,"in user.controller.spec.ts \u5167"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-tsx"},'//runTest\u662f\u6703\u986f\u793a\u5728Terminal\u4e0a\ndescribe("runTest", () => {\n  it("should return an array of users", () => {\n    //\u9810\u671f\u56de\u50b3\u7684\u8cc7\u6599\n    const result = [\n      { _id: 1, _name: "Michael", _age: 25 },\n      { _id: 2, _name: "Mary", _age: 27 },\n    ];\n    //jest\u6703\u76e3\u8996usersService.()\uff0c\u4e26\u7d66\u4e88\u5047\u8cc7\u6599 result\n    jest.spyOn(usersService, "getAllUsers").mockImplementation(() => result);\n\n    usersController.getAllUsers(Request, Response, Next).then((data) => {\n      //\u9810\u671fdata\u6703\u8ddfresult\u4e00\u6a23\n      expect(data).toBe(result);\n    });\n  });\n});\n')),(0,l.kt)("h3",{id:"\u55ae\u5143\u6e2c\u8a66\u6bd4\u8f03\u7c21\u6f54\u7684\u5beb\u6cd5"},"\u55ae\u5143\u6e2c\u8a66(\u6bd4\u8f03\u7c21\u6f54\u7684\u5beb\u6cd5)"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-tsx"},'test("Check the result of 5 + ", () => {\n  expect(5 + 2).toBe(7);\n});\n')),(0,l.kt)("h3",{id:"\u6e2c\u8a66\u539f\u7406"},"\u6e2c\u8a66\u539f\u7406"),(0,l.kt)("p",null,"\u4e0b npm test\uff0c\u6703\u53bb\u627e.spec \u7d50\u5c3e\u7684\u6a94\u6848\uff0c\u986f\u793a\u7d50\u679c\u3002"),(0,l.kt)("h3",{id:"success-result"},"Success Result"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-tsx"},'> test@0.0.1 test /home/ardomus/project/test\n> jest\n\n PASS  src/app.controller.spec.ts\n  AppController\n    Print Word Test1\n      \u2713 should return "Hello World!" (11 ms)\n    Print Word Test2\n      \u2713 should return "Hello World!" (2 ms)\n\nTest Suites: 1 passed, 1 total   (\u4ee3\u8868\u6709\u5e7e\u500b.spec\u7684\u6a94\u6848)\nTests:       2 passed, 2 total   (\u4ee3\u8868\u6709\u5e7e\u500bdescribe\u6e2c\u8a66)\nSnapshots:   0 total\nTime:        0.897 s, estimated 3 s\nRan all test suites.\n')),(0,l.kt)("h3",{id:"fail-result"},"Fail Result"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-tsx"},"Expected: 14\nReceived: 13\n\n      16 |\n      17 |   it('should be defined', () => {\n    > 18 |     expect(5 + 8).toBe(14);\n         |                   ^\n      19 |   });\n      20 | });\n      21 |\n")),(0,l.kt)("h3",{id:"parmeter"},"parmeter"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},".toBe: \u9700\u8981\u5b8c\u5168\u7b26\u5408")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-tsx"},'//\u8981\u6e2c\u8a66\u7684\u51fd\u5f0f\nconst sum = (a, b) => {\n  return a + b;\n};\n\ntest("Check the result of 5 + 2", () => {\n  //\u5728 expect \u4e2d\u547c\u53eb\u51fd\u5f0f\u6e2c\u8a66\u7d50\u679c\n  expect(sum(5, 2)).toBe(7);\n});\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},".toMatch: \u642d\u914d\u6b63\u898f\u8868\u9054\u5f0f\u6aa2\u67e5")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-tsx"},'test("Use toMatch test", () => {\n  //\u642d\u914d\u6b63\u898f\u8868\u9054\u5f0f\n  expect("Happy new year.").toMatch(/new/);\n});\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},".toEqual: \u91dd\u5c0d\u300e\u7269\u4ef6\u300f\u7b49\u65bc\u671f\u671b\u503c")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript="},"test('Check the object type', () => {\n    let peopleA = {\n        name: 'GQSM'\n    }\n    peopleA.age = 25\n\n    //\u6e2c\u8a66\u5b57\u4e32\n    expect(peopleA.name).toBe('GQSM')\n    //\u6e2c\u8a66\u7269\u4ef6\n    expect(peopleA).toEqual({ name: 'GQSM', age: 25 })\n})\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},".not: \u9810\u9632\u51fd\u5f0f\u56de\u50b3\u67d0\u500b\u7d50\u679c")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-tsx"},'test("Use not", () => {\n  let peopleA = {\n    name: "GQSM",\n  };\n  //\u78ba\u8a8d name \u4e0d\u7b49\u65bc\u7a7a\n  expect(peopleA.name).not.toBe("");\n  peopleA.name = "";\n  //\u5982\u679c name \u662f\u7a7a\u7684\n  expect(peopleA.name).not.toBe("");\n});\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},".toContain: \u662f\u91dd\u5c0d\u9663\u5217\u7684\u5143\u7d20\uff0c\u53ea\u8981\u6709\u51fa\u73fe\u5c31\u7b97\u5c0d")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript="},"test('For array test in jest',()=>{\n    let arrA = ['A','B','C']\n\n    //\u6aa2\u67e5\u9663\u5217\u5167\u662f\u5426\u542b\u6709\u67d0\u503c\n    expect(arrA).toContain('B')\n\n    //\u642d\u914d\u8ff4\u5708\u6aa2\u67e5\u6bcf\u500b\u4f4d\u7f6e\u90fd\u4e0d\u7b49\u65bc\u7a7a\n    for(let i in arrA){\n        expect(arrA[i]).not.toBe('')\n    }\n})\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5224\u65b7 undefined \u3001 null \u3001 true")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-tsx"},'test("Special value", () => {\n  //\u671f\u671b\u503c\u70ba true\n  expect(true).toBeTruthy();\n\n  //\u671f\u671b\u503c\u70ba false\n  expect(false).toBeFalsy();\n\n  //\u671f\u671b\u503c\u70ba null\n  expect(null).toBeNull();\n\n  //\u671f\u671b\u503c\u70ba undefined\n  expect(undefined).toBeUndefined();\n\n  //\u671f\u671b\u503c\u70ba undefined \u4e4b\u5916\u7684\u503c\n  expect(null).toBeDefined();\n});\n')),(0,l.kt)("h3",{id:"linux-command"},"linux command"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'    "test": "jest",  \uff08\u55ae\u7d14jest)\n    "test:watch": "jest --watch",\n    "test:cov": "jest --coverage",  \uff08\u6703\u7522\u751f\u8986\u84cb\u7387\u5831\u544a)\n    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",\n    "test:e2e": "jest --config ./test/jest-e2e.json" \uff08\u9032\u884ce2e\u6e2c\u8a66)\n')),(0,l.kt)("h3",{id:"npm-testwatch"},"npm test:watch"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-tsx"},"Watch Usage\n \u203a Press a to run all tests.\n \u203a Press f to run only failed tests.\n \u203a Press o to only run tests related to changed files.\n \u203a Press p to filter by a filename regex pattern.\n \u203a Press t to filter by a test name regex pattern.\n \u203a Press q to quit watch mode.\n \u203a Press Enter to trigger a test run.\n")),(0,l.kt)("p",null,"a: \u5168\u90e8\u9805\u76ee\u6e2c\u8a66\nf: \u53ea\u91dd\u5c0d\u525b\u525b\u6e2c\u8a66\u5931\u6557\u9805\u76ee\no: \u91dd\u5c0d\u525b\u6709\u8b8a\u52d5\u7684\u6a94\u6848\u9032\u884c\u6e2c\u8a66\np: \u7528\u6a94\u540d\u70ba key \u9032\u884c\u6e2c\u8a66\u9805\u76ee\nt: \u7528\u6e2c\u8a66 tag \u70ba key \u9032\u884c\u6e2c\u8a66\u9805\u76ee\nq: \u96e2\u958b\nenter: \u91dd\u5c0d\u525b\u525b\u7684\u6e2c\u8a66\u5728\u9032\u884c\u4e00\u6b21"),(0,l.kt)("h3",{id:"\u8a2d\u8a08\u81ea\u52d5\u5316\u6e2c\u8a66\u6d41\u7a0b\u5728-dcs-account-module"},"\u8a2d\u8a08\u81ea\u52d5\u5316\u6e2c\u8a66\u6d41\u7a0b\u5728 DCS account Module"),(0,l.kt)("p",null,"\u57fa\u672c\u689d\u4ef6"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u6bcf\u4e00\u500b function \u90fd\u9700\u8981 token \u624d\u80fd\u505a"),(0,l.kt)("li",{parentName:"ol"},"\u8981\u505a function \u5305\u542b\n(1) GET: Get account list\n(2) POST: Create new account\n(3) DELETE: Delete an account")),(0,l.kt)("p",null,"\u7a0b\u5f0f\u5982\u4e0b:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u81ea\u52d5\u5316\u6e2c\u8a66\u5148\u62ff\u5230 token"),(0,l.kt)("li",{parentName:"ol"},"\u5148\u505a Get account list: \u76ee\u7684\u8981\u53ef\u4ee5\u62ff\u5230\u76ee\u524d\u8cc7\u6599\u5eab\u7684\u6240\u6709\u5e33\u865f list\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u518d\u505a Create new account: \u76ee\u7684\u8981\u78ba\u5b9a\u9019\u500b\u529f\u80fd\u53ef\u4ee5\u65b0\u589e\u5e33\u865f\uff0c\u662f\u4e0d\u662f\u65b0\u589e\u5b8c\u4e4b\u5f8c\u5728\u55ae\u67e5 get account by name \u7684\u9019\u500b RESTful api \u5c31\u53ef\u4ee5\u9a57\u8b49\u9019\u500b\u529f\u80fd\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u6700\u5f8c\u505a Delete an account: \u76ee\u7684\u8981\u78ba\u5b9a\u9019\u500b\u529f\u80fd\u53ef\u4ee5\u65b0\u589e\u5e33\u865f\uff0c\u662f\u4e0d\u662f\u65b0\u589e\u5b8c\u4e4b\u5f8c\u5728\u55ae\u67e5 get account by name \u7684\u9019\u500b RESTful api \u5c31\u53ef\u4ee5\u9a57\u8b49\u9019\u500b\u529f\u80fd\u3002")),(0,l.kt)("h3",{id:"\u89e3\u6c7a-jest-\u5728-test-\u6642\u627e\u4e0d\u5230-module-\u554f\u984c-20210701-\u9806\u5229\u89e3\u6c7a"},"\u89e3\u6c7a Jest \u5728 test \u6642\u627e\u4e0d\u5230 module \u554f\u984c (20210701 \u9806\u5229\u89e3\u6c7a)"),(0,l.kt)("p",null,"error message:\nCannot find module 'src/account/account.dto' from 'auth.service.ts'"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Reference from ",(0,l.kt)("a",{parentName:"strong",href:"https://github.com/jest-community/vscode-jest/issues/382"},"https://github.com/jest-community/vscode-jest/issues/382"))),(0,l.kt)("p",null,"\u56e0\u70ba\u5728 package.json \u5167\uff0cjest \u6703\u81ea\u5b9a\u7fa9\u8def\u5f91\uff0c\u8981\u53bb\u66f4\u6539\u5176\u5167\u5bb9\n\u8acb\u4f9d\u7167\u4e0b\u65b9\u5167\u5bb9\u4fee\u6539"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'- rootDir \u8981\u7531"src"\u6539\u6210"./"\n- \u589e\u52a0"modulePaths": ["<rootDir>"],\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'    "jest": {\n        "moduleFileExtensions": [\n            "js",\n            "json",\n            "ts"\n        ],\n\n        "rootDir": "./",\n        "modulePaths": [\n            "<rootDir>"\n          ],\n        "testRegex": ".spec.ts$",\n        "transform": {\n            "^.+\\\\.(t|j)s$": "ts-jest"\n        },\n        "coverageDirectory": "../coverage",\n        "testEnvironment": "node"\n    }\n')),(0,l.kt)("h3",{id:"\u91cd\u9ede\u5728-mock"},"\u91cd\u9ede\u5728 mock"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript="}," const accountServiceFindAllSpy = jest.spyOn(\n      AccountService, 'getAll').mockResolvedValue(accountData);\n    const result = await service.getAll(true);\n\nexpect(accountServiceFindAllSpy).toBeCalled();\nexpect(result).toEqual(accountData);\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript="},"  const mockUserService = {};\n\n\n  beforeEach(async () => {\n    const app: TestingModule = await Test.createTestingModule({\n      controllers: [UsersController],\n      providers: [UsersService],\n    })\n    .overrideProvider(UsersService)\n    .useValue(mockUserService)\n    .compile();\n")),(0,l.kt)("h1",{id:"jest-\u7b46\u8a18"},"Jest \u7b46\u8a18"),(0,l.kt)("h3",{id:"\u55ae\u5143\u6e2c\u8a66\u7684\u76ee\u7684"},"\u55ae\u5143\u6e2c\u8a66\u7684\u76ee\u7684"),(0,l.kt)("p",null,"\u65b7\u958b\u6240\u6709\u76f8\u4f9d\u7684 dependies\uff0c\u55ae\u7d14\u5c0d service function \u505a\u908f\u8f2f\u6e2c\u8a66\u53ca controller \u505a\u8def\u7531\u6e2c\u8a66"),(0,l.kt)("h3",{id:"\u89e3\u6c7a\u6240\u6709\u76f8\u4f9d\u7684-dependies-\u554f\u984c"},"\u89e3\u6c7a\u6240\u6709\u76f8\u4f9d\u7684 dependies \u554f\u984c"),(0,l.kt)("p",null,"\u8981\u5efa\u7acb mock function \u5410\u51fa dependies \u7684\u7d50\u679c"),(0,l.kt)("p",null,"example:"),(0,l.kt)("p",null,"class ApiServiceMock {\nreturn {\nname: '{name}',\ngrades: ","[1,2,3]",";\n}\n}"))}d.isMDXComponent=!0}}]);